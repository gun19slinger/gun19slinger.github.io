function IconView(t){this.container=t.container,this.measurements=t.measurements,this.items=t.items||[],this.contWidth=300,this.contHeight=200,this.itemWidth=80,this.itemHeight=60,this.checkButton=t.checkButton,this.deleteButton=t.deleteButton,this.list=null,this.checkedItems={},this.init(),this.container.addEventListener("mousedown",function(t){t.preventDefault()}),document.addEventListener("click",this.documentOnClick.bind(this))}IconView.prototype.init=function(){this.itemsBEMNames=this.getBEMNames(this.container.className),this.createList(),this.addItems(this.items),this.setMeasurements(this.measurements)},IconView.prototype.documentOnClick=function(t){if(1===t.which){var e=t.target;if(e===this.checkButton)this.toggleCheckAll();else if(e===this.deleteButton)this.deleteChecked();else for(;e!==t.currentTarget;)"LI"===e.tagName&&e.classList.contains(this.itemsBEMNames.item)&&this.toggleCheck(e),e=e.parentNode}},IconView.prototype.toggleCheck=function(t){t.classList.contains(this.itemsBEMNames.checkedItem)?this.uncheckOne(t):this.checkOne(t)},IconView.prototype.toggleCheckAll=function(){0===Object.keys(this.checkedItems).length?this.checkAll():this.uncheckAll()},IconView.prototype.checkOne=function(t){t.classList.add(this.itemsBEMNames.checkedItem),this.checkedItems[t.dataset.id]=t},IconView.prototype.uncheckOne=function(t){t.classList.remove(this.itemsBEMNames.checkedItem),delete this.checkedItems[t.dataset.id]},IconView.prototype.checkAll=function(){this.list.querySelectorAll("li").forEach(function(t){this.checkOne(t)}.bind(this))},IconView.prototype.uncheckAll=function(){for(var t in this.checkedItems)this.uncheckOne(this.checkedItems[t])},IconView.prototype.deleteChecked=function(){for(var t in this.checkedItems){var e=this.checkedItems[t];e.parentNode.removeChild(e),delete this.checkedItems[e.dataset.id]}this.checkProportions()},IconView.prototype.setMeasurements=function(t){t&&(this.contWidth=t.contWidth,this.contHeight=t.contHeight,this.itemWidth=t.itemWidth,this.itemHeight=t.itemHeight),this.container.style.width=this.contWidth+"px",this.container.style.height=this.contHeight+"px",this.container.style.visibility="visible",this.list.querySelectorAll("li").forEach(function(t){this.setItemMeasurements(t)}.bind(this)),this.checkProportions()},IconView.prototype.setItemMeasurements=function(t){var e=this.getMargins(),i=this.getPadding();t.style.width=this.itemWidth+"px",t.style.height=this.itemHeight+"px",t.style.marginLeft=e.left+"px",t.style.marginTop=e.top+"px",t.style.paddingBottom=i+"px";var s=t.firstChild;s.style.width=s.style.height=Math.round(75*this.itemWidth/100)+"px"},IconView.prototype.createList=function(){this.list=document.createElement("ul"),this.list.classList.add(this.itemsBEMNames.list),this.container.appendChild(this.list)},IconView.prototype.createItem=function(t){var e=document.createElement("li");e.classList.add(this.itemsBEMNames.item),e.setAttribute("data-id",t.id);var i=document.createElement("img");i.classList.add(this.itemsBEMNames.image),i.src=t.img,i.alt=t.text,e.appendChild(i);var s=document.createElement("span");return s.classList.add(this.itemsBEMNames.caption),s.innerHTML=t.text,e.appendChild(s),e},IconView.prototype.addItems=function(t){t.forEach(function(t){var e=this.createItem(t);this.list.appendChild(e)}.bind(this))},IconView.prototype.addItem=function(t){var e=this.createItem(t);this.list.appendChild(e),this.setItemMeasurements(e),this.items.push(t),this.checkProportions()},IconView.prototype.getMargins=function(){var t=Math.round(this.contWidth/this.itemWidth);t>this.items.length&&(t=this.items.length);var e=this.contWidth-t*this.itemWidth;e<10&&(t-=1,e=this.contWidth-t*this.itemWidth);for(var i=e/(t+1),s=0,h=this.contHeight;h>this.itemHeight;)h-=this.itemHeight,s++;if(1===s)n=5;else var n=(this.contHeight-s*this.itemHeight)/(s+1);return{left:i,top:n}},IconView.prototype.getPadding=function(){var t=this.itemWidth-this.itemHeight,e=0;return t<=20&&t>=0&&(e=t+10),e},IconView.prototype.getBEMNames=function(t){return{list:t+"__list",item:t+"__item",image:t+"__image",caption:t+"__caption",checkedItem:t+"__item--checked"}},IconView.prototype.checkProportions=function(){var t=getComputedStyle(this.container),e=this.container.offsetWidth-this.container.clientWidth-parseInt(t.borderLeftWidth)-parseInt(t.borderRightWidth);this.container.style.width=this.contWidth+e+"px"};